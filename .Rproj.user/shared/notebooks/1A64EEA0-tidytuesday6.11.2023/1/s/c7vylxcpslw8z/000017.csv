"0","#create party factors and determine the fraction of votes each candidate got"
"0","winning_party = house |>"
"0","  group_by(year, state, district) |>"
"0","  mutate(frac_votes = candidatevotes / totalvotes,"
"0","         party = case_when(party == ""DEMOCRAT"" ~ ""DEMOCRAT"","
"0","                            party == ""REPUBLICAN"" ~ ""REPUBLICAN"","
"0","                            party != ""DEMOCRAT"" | party != ""REPUBLICAN"" ~ "
"0","                              ""OTHER""),"
"0","         party = factor(party, "
"0","                        levels = c(""DEMOCRAT"", ""OTHER"", ""REPUBLICAN""))) |>"
"0","#filter for the candidate who got the highest percentage of votes for each year,"
"0","# state, and district. In other words, this is the winning candidate, and their"
"0","# party information is saved in the `party` column."
"0","  filter(frac_votes == max(frac_votes))"
"0",""
"0","#Count the instances for each party"
"0","winning_party1 = winning_party |>"
"0","  group_by(year) |>"
"0","  count(party, .drop = FALSE)"
"0",""
"0","#Plot the count"
"0","winning_party1 |>"
"0","  group_by(year) |>"
"0","  ggplot(aes(x = year, y = n, color = party)) +"
"0","  geom_point() +"
"0","  geom_line() +"
"0","  scale_color_manual(values = c(""blue"", ""darkgreen"", ""red"")) +"
"0","  labs("
"0","    x = ""Year"","
"0","    y = ""Number of Counties Won"","
"0","    title = ""House Elections Historical Distribution, Compiled by County"""
"0","  )"
